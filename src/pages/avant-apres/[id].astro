---
import BaseLayout from '@/layouts/BaseLayout.astro';
import BeforeAfterSlider from '@/components/BeforeAfterSlider.astro';
import { getPublicAvantApresCase } from '@/lib/cms/avantApres';

Astro.response.headers.set('Cache-Control', 'no-store');
const { id } = Astro.params;
const item = id ? await getPublicAvantApresCase(id) : null;
if (!item) {
  return Astro.redirect('/avant-apres');
}
---

<BaseLayout title={item.title} description="Avant/apres avec consentement. Les resultats varient selon chaque patient.">
  <section class="mx-auto max-w-5xl px-4 py-14">
    <a href="/avant-apres" class="text-sm font-semibold text-ink/70 hover:text-ink">← Avant-apres</a>
    <h1 class="mt-3 font-display text-4xl tracking-tight">{item.title}</h1>
    <div class="mt-3 text-sm text-ink/60">{item.zone ?? '—'}</div>
    {item.caption ? <p class="mt-3 text-lg text-ink/75">{item.caption}</p> : null}

    <div class="mt-8">
      <BeforeAfterSlider beforeUrl={item.beforeUrl} afterUrl={item.afterUrl} />
    </div>

    <div class="mt-10 rounded-3xl border border-ink/10 bg-mist p-6 text-sm text-ink/75">
      Les resultats varient selon chaque patient. Toute publication se fait avec consentement.
    </div>
  </section>
</BaseLayout>
