---
import CmsLayout from '@/layouts/CmsLayout.astro';
import { cmsInterventions } from '@/lib/cms/mock';

export async function getStaticPaths() {
  return cmsInterventions.map((i) => ({ params: { slug: i.slug } }));
}

const { slug } = Astro.params;
const item = cmsInterventions.find((i) => i.slug === slug) ?? cmsInterventions[0];
---

<CmsLayout title="Edition intervention">
  <div class="grid gap-6 lg:grid-cols-[minmax(0,1fr)_320px]">
    <section class="cms-card p-7">
      <div class="text-xs font-semibold uppercase tracking-wide text-ink/50">Intervention</div>
      <h1 class="mt-2 font-display text-3xl tracking-tight">{item.title}</h1>

      <div class="mt-8 grid gap-5">
        <label class="grid gap-2 text-sm">
          <span class="font-semibold text-ink/80">Titre</span>
          <input class="cms-input" value={item.title} />
        </label>
        <label class="grid gap-2 text-sm">
          <span class="font-semibold text-ink/80">Description courte</span>
          <textarea rows={3} class="cms-textarea">
            Description a completer.
          </textarea>
        </label>
        <label class="grid gap-2 text-sm">
          <span class="font-semibold text-ink/80">Categorie</span>
          <select class="cms-select">
            <option selected={item.category === 'Medecine esthetique'}>medecine-esthetique</option>
            <option selected={item.category === 'Visage'}>visage</option>
            <option selected={item.category === 'Silhouette'}>silhouette</option>
            <option selected={item.category === 'Seins'}>seins</option>
            <option selected={item.category === 'Chirurgie reparatrice'}>chirurgie-reparatrice</option>
            <option selected={item.category === 'Chirurgie de la main'}>chirurgie-de-la-main</option>
            <option selected={item.category === 'Intime'}>intime</option>
          </select>
        </label>
        <label class="grid gap-2 text-sm">
          <span class="font-semibold text-ink/80">Ordre</span>
          <input class="cms-input" value={item.order} />
        </label>
        <label class="grid gap-2 text-sm">
          <span class="font-semibold text-ink/80">Contenu (Markdown)</span>
          <textarea rows={10} class="cms-textarea">
            ## Indications

            Contenu exemple a remplacer.
          </textarea>
        </label>
      </div>
    </section>

    <aside class="cms-panel p-6">
      <div class="text-xs font-semibold uppercase tracking-wide text-ink/50">Publication</div>
      <div class="mt-4 grid gap-3">
        <label class="flex items-center justify-between rounded-2xl border border-ink/10 bg-paper px-4 py-3 text-sm">
          <span>Statut</span>
          <select class="bg-transparent text-sm">
            <option selected={item.status === 'Brouillon'}>Brouillon</option>
            <option selected={item.status === 'Publie'}>Publie</option>
          </select>
        </label>
        <label class="grid gap-2 text-sm">
          <span class="font-semibold text-ink/80">Slug</span>
          <input class="cms-input" value={item.slug} />
        </label>
      </div>

      <div class="mt-6 space-y-3">
        <button type="button" class="btn btn-pill btn-md btn-primary w-full">Enregistrer</button>
        <a href={`/interventions/${item.category.toLowerCase().replace(/\s/g, '-')}/${item.slug}`} class="btn btn-pill btn-md btn-secondary w-full">
          Apercu public
        </a>
      </div>
      <div class="mt-4 text-xs text-ink/60">UI uniquement â€” sauvegarde activee apres integration.</div>
    </aside>
  </div>
</CmsLayout>
