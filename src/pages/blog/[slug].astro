---
import BaseLayout from '@/layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.filter((p) => !p.data.draft).map((p) => ({ params: { slug: p.slug }, props: { post: p } }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<BaseLayout title={post.data.title} description={post.data.description}>
  <section class="mx-auto max-w-3xl px-4 py-14">
    <a href="/blog" class="text-sm font-semibold text-ink/70 hover:text-ink">‚Üê Blog</a>
    <h1 class="mt-3 font-display text-4xl tracking-tight">{post.data.title}</h1>
    <p class="mt-2 text-sm text-ink/60">{post.data.date.toLocaleDateString('fr-FR')}</p>
    <p class="mt-4 text-lg text-ink/75">{post.data.description}</p>

    <article class="prose-med mt-10 max-w-none">
      <Content />
    </article>

    <div class="mt-10 rounded-3xl border border-ink/10 bg-paper p-6 text-sm text-ink/70">
      Information generale - ne remplace pas une consultation.
    </div>
  </section>
</BaseLayout>
